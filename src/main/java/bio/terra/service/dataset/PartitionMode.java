package bio.terra.service.dataset;

import com.google.cloud.bigquery.RangePartitioning;
import com.google.cloud.bigquery.TimePartitioning;

/** Common interface for descriptions of how primary data should be partitioned in BigQuery. */
public interface PartitionMode {

    /** Get a stable identifier for this mode which can be persisted in table metadata. */
    String getName();

    /**
     * Convert this mode to a BigQuery `TimePartitioning` instance, or null.
     *
     * If this does not return null, `asRangePartitioning()` must return null.
     */
    TimePartitioning asTimePartitioning();

    /**
     * Convert this mode to a BigQuery `RangePartitioning` instance, or null.
     *
     * If this does not return null, `asTimePartitioning()` must return null.
     */
    RangePartitioning asRangePartitioning();

    /**
     * Get the BigQuery name of the column generated by this partitioning mode, if any.
     *
     * The returned value may contain name-aliasing (_generated AS something_else).
     */
    String getGeneratedColumn();
}
