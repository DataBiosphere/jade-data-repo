
name: Staging Weekly
on:
  pull_request
#  schedule:
#    - cron: '0 3 * * 7' # run at 2 AM UTC

jobs:
  update_image:
    strategy:
      matrix:
        os: [ubuntu-latest]
    runs-on: ${{ matrix.os }}
    steps:
      - name: Checkout
        uses: actions/checkout@v2
        with:
          fetch-depth: 0
      - name: 'Get Previous tag'
        id: apiprevioustag
        uses: "broadinstitute/github-action-get-previous-tag@master"
        env:
          GITHUB_TOKEN: "${{ secrets.GITHUB_TOKEN }}"
      - name: 'Authenicate with google'
        uses: GoogleCloudPlatform/github-actions/setup-gcloud@master
        with:
          version: '290.0.1'
          project_id: 'broad-jade-dev'
          service_account_key: ${{ secrets.GOOGLE_SA_CERT }}
          export_default_credentials: true
      - run: gcloud info
